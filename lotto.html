<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>로또 1211회 결과</title>
<style>
body { font-family: Arial, sans-serif; padding: 30px; }
button { padding: 10px 15px; margin-right: 10px; }
table { border-collapse: collapse; margin-top: 20px; }
td, th { border: 1px solid #ccc; padding: 8px 12px; }
</style>
</head>
<body>

<h2>로또 1211회 결과</h2>

<button onclick="loadLotto()">결과 가져오기</button>
<button onclick="saveCSV()">CSV 저장</button>

<table id="resultTable" style="display:none;">
<thead>
<tr>
<th>회차</th>
<th>추첨일</th>
<th>번호1</th>
<th>번호2</th>
<th>번호3</th>
<th>번호4</th>
<th>번호5</th>
<th>번호6</th>
<th>보너스</th>
<th>당첨자수</th>
<th>금액</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
const DRAW_NO = 1211;
let lottoData = null;

async function loadLotto() {
    const url = `https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=${DRAW_NO}`;
    const res = await fetch(url);
    const d = await res.json();

    if (d.returnValue !== "success") {
        alert("데이터를 가져오지 못했습니다.");
        return;
    }

    lottoData = {
        회차: d.drwNo,
        추첨일: d.drwNoDate,
        번호1: d.drwtNo1,
        번호2: d.drwtNo2,
        번호3: d.drwtNo3,
        번호4: d.drwtNo4,
        번호5: d.drwtNo5,
        번호6: d.drwtNo6,
        보너스: d.bnusNo,
        당첨자수: d.firstPrzwnerCo,
        금액: d.firstWinamnt
    };

    showTable(lottoData);
    localStorage.setItem("lotto1211", JSON.stringify(lottoData));
}

function showTable(data) {
    const table = document.getElementById("resultTable");
    const tbody = table.querySelector("tbody");
    tbody.innerHTML = "";

    const row = document.createElement("tr");
    Object.values(data).forEach(v => {
        const td = document.createElement("td");
        td.textContent = v;
        row.appendChild(td);
    });

    tbody.appendChild(row);
    table.style.display = "table";
}

function saveCSV() {
    if (!lottoData) {
        alert("먼저 결과를 가져오세요.");
        return;
    }

    const headers = Object.keys(lottoData).join(",");
    const values = Object.values(lottoData).join(",");
    const csv = headers + "\n" + values;

    const blob = new Blob([csv], { type: "text/csv" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "lotto_1211.csv";
    a.click();
}

window.onload = () => {
    const saved = localStorage.getItem("lotto1211");
    if (saved) showTable(JSON.parse(saved));
};
</script>

</body>
</html>