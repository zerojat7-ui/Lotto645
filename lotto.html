<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>로또 1211회 결과</title>
<style>
body {
    font-family: Arial, sans-serif;
    padding: 40px;
    background: #f5f5f5;
}
h2 { margin-bottom: 15px; }
button {
    padding: 10px 16px;
    font-size: 15px;
    margin-right: 10px;
    cursor: pointer;
}
#status {
    margin-top: 10px;
    color: #555;
}
table {
    border-collapse: collapse;
    margin-top: 20px;
    background: white;
}
th, td {
    border: 1px solid #ccc;
    padding: 10px 14px;
    text-align: center;
}
</style>
</head>

<body>

<h2>로또 1211회 결과</h2>

<button onclick="loadLotto()">결과 가져오기</button>
<button onclick="saveCSV()">CSV 저장</button>

<div id="status">대기 중...</div>

<table id="resultTable" style="display:none;">
<thead>
<tr>
<th>회차</th>
<th>추첨일</th>
<th>번호1</th>
<th>번호2</th>
<th>번호3</th>
<th>번호4</th>
<th>번호5</th>
<th>번호6</th>
<th>보너스</th>
<th>당첨자수</th>
<th>당첨금</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
let lottoData = null;

async function loadLotto() {
    document.getElementById("status").textContent = "불러오는 중...";

    try {
        const target =
        "https://www.dhlottery.co.kr/common.do?method=getLottoNumber&drwNo=1211";

        const proxy =
        "https://api.allorigins.win/raw?url=" + encodeURIComponent(target);

        const res = await fetch(proxy);
        const d = await res.json();

        if (d.returnValue !== "success") {
            throw new Error("데이터 없음");
        }

        lottoData = {
            회차: d.drwNo,
            추첨일: d.drwNoDate,
            번호1: d.drwtNo1,
            번호2: d.drwtNo2,
            번호3: d.drwtNo3,
            번호4: d.drwtNo4,
            번호5: d.drwtNo5,
            번호6: d.drwtNo6,
            보너스: d.bnusNo,
            당첨자수: d.firstPrzwnerCo,
            당첨금: d.firstWinamnt
        };

        showTable(lottoData);
        document.getElementById("status").textContent = "불러오기 완료";

    } catch (e) {
        document.getElementById("status").textContent =
        "데이터를 불러오지 못했습니다.";
    }
}

function showTable(data) {
    const tbody = document.querySelector("#resultTable tbody");
    tbody.innerHTML = "";

    const tr = document.createElement("tr");
    Object.values(data).forEach(v => {
        const td = document.createElement("td");
        td.textContent = typeof v === "number"
            ? v.toLocaleString()
            : v;
        tr.appendChild(td);
    });

    tbody.appendChild(tr);
    document.getElementById("resultTable").style.display = "table";
}

function saveCSV() {
    if (!lottoData) {
        alert("먼저 결과를 가져오세요.");
        return;
    }

    const headers = Object.keys(lottoData).join(",");
    const values = Object.values(lottoData).join(",");
    const csv = headers + "\n" + values;

    const blob = new Blob([csv], { type: "text/csv" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "lotto_1211.csv";
    a.click();
}
</script>

</body>
</html>